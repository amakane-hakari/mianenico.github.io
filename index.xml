<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Miane activity</title>
    <link>https://mianenico.github.io/</link>
    <description>Recent content on Miane activity</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Wed, 02 Jun 2021 02:51:00 +0900</lastBuildDate><atom:link href="https://mianenico.github.io/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ツイ禁日記3</title>
      <link>https://mianenico.github.io/article/dairy20210605/</link>
      <pubDate>Sun, 06 Jun 2021 02:47:20 +0900</pubDate>
      
      <guid>https://mianenico.github.io/article/dairy20210605/</guid>
      <description>とにかく暇を持て余す Twitterやらないと時間がかなりあるように感じる。どれだけTwitterで無駄にしていたのだろうか。でもその時間を有効活用できてはいない。プログラミングとかしているけどなかなか進まず。やっぱり決断力が不足している感覚がある。
慣れない言語での開発 もう一つ進まないのはRuby以外でコーディングをしているという点。なにかやろうとするたびに手探りでコードを書いていくことになるのでちょっとしたことをやろうとするだけでも時間がかかる。慣れているRubyでやればいいじゃないかという話ではあるけれど仕事で嫌になるほどコード見ているのもあってそっちはそっちで気が進まない。どちらかというと新しいことをしたいというモチベーションのほうがある。
アーキテクチャどうする問題 AWSでなにかしようとしたときにとにかくお金がかかる。何が金かかるかってデータベース。とにかくこれだけは如何ともし難い。RDBなら開発中は問題にならないけれどそれ以外は自己投資にしてはちょっと覚悟必要なレベル。
まあ低コストでやろうとするとMySQLあたり自前で構築するのが無難かな。
なんのための仕事なのか お金稼ぐための仕事なんだけど仕事するために生活の一部を犠牲にしていてその犠牲の結果がコストになっている。やはり労働は悪だと思わざるを得ない。
Railsの設計 どこのソース見てもなんかコントローラーがでかいというかコントローラーにロジック書きすぎなんだよね。コントローラーはほとんど何もしなくていいというかRailsのスタックにあるクラスはコード書かなくても役割持っているからコード書くなと思っているのだけど。
コントローラーはパラメーターをビジネスロジックに投げつけるだけでいいし、ActiveRecordはビジネスロジックの結果を保存したり取り出したりするだけでいいし、ビューはHTML出力されるだけでいい。
個人的にはマスタメンテ系のフォーム以外はフォーム用のActiveModelを作成してそこでバリデーションすべきだと思っているし、入力をDBに保存するための加工に関してはActiveRecordに書くべきではなくプレーンオブジェクトとして実装すべきと思っている。要するにRailsのMVCの間に1枚レイヤーが足りていない。
フォームオブジェクトはparamsを受け取ってインスタンス変数にマッピング、その内容を検証する。検証の結果問題なければサービスオブジェクトに必要なデータを送る。ここもサービスビルダーオブジェクトがあっていい。サービスオブジェクトは入力を処理してDBにActiveRecord経由でアクセスする。ActiveRecordはインフラレイヤーなのでビジネスロジックは書かない。
Railsのコードがひどくなる理由はアプリケーションサービスとDBテーブルは複雑な多対多の関係を持つのにアプリケーションサービスのロジックをActiveRecordに書くから。あるいはコントローラーをアプリケーションサービスと混合してアプリケーションサービスのロジックをコントローラーに書くから。
あと何故かappディレクトリの下にservicesディレクトリ作りたがる人多い気がするんだけど、サービスはモデルなんだからmodelsの下にserviceネームスペース作ってそこに入れたほうがいいと思う。フォームもそうなんだけどMでもVでもCでもないコードとかなんのためのMVCだよって話なので。modelsの下をgrepするだけで目的のコードが見つかるのが理想。appから外れてlibの下にコード書くのはもっと最悪。プログラマが書きたいコードはだいたいモデルです。</description>
    </item>
    
    <item>
      <title>AWS SAM with TypeScript</title>
      <link>https://mianenico.github.io/article/getting-started-sam-typescript/</link>
      <pubDate>Sat, 05 Jun 2021 03:14:21 +0900</pubDate>
      
      <guid>https://mianenico.github.io/article/getting-started-sam-typescript/</guid>
      <description>いつも調べながらやってわからなくなる 何度か環境作っているのだけど毎回毎回忘れててコピペみたいになって覚えられない。二次情報は正解へ最短距離でたどり着くのだけれど応用の結果なので基礎となる知識が身につかない。きちんとやるならやはり公式ドキュメントをちゃんと見ながらやるべきだと感じたので公式ドキュメントを参考にしながら構築していく。
SAM CLIでnodejsのプロジェクト作成 sam initでパッと作成する。特に言うことなし。使用したテンプレートはQuick Start: From Scratchなので最初の状態はこちらを参照。
TypeScriptの設定をする 作成されたプロジェクトにpackage.jsonなどがあるのでTypeScriptをインストールする。
参考:https://www.typescriptlang.org/download
npm install typescript --save-dev 次にtsconfig.jsonにTypeScriptの設定を書いていく。ベースとなる設定はnpmでインストールできる。今回はnode14のプロジェクトだったので@tsconfig/node14をインストールして使う。
参考:https://www.typescriptlang.org/docs/handbook/tsconfig-json.html#tsconfig-bases
npm install @tsconfig/node14 --save-dev 肝心のtsconfig.jsonは以下の通り。
{ &amp;quot;extends&amp;quot;: &amp;quot;@tsconfig/node14/tsconfig.json&amp;quot;, &amp;quot;compilerOptions&amp;quot;: { &amp;quot;rootDir&amp;quot;: &amp;quot;src&amp;quot;, &amp;quot;outDir&amp;quot;: &amp;quot;dist&amp;quot; }, &amp;quot;include&amp;quot;: [&amp;quot;src/**/*&amp;quot;], &amp;quot;exclude&amp;quot;: [&amp;quot;node_modules&amp;quot;, &amp;quot;**/*.spec.ts&amp;quot;] } 参考:https://www.typescriptlang.org/tsconfig
それぞれの項目は公式ドキュメントを見ればよい。srcディレクトリ以下にTypeScriptのソースを書いていきdistディレクトリに出力するよう設定した。
rootDirについてはデフォルトでもどうにかなるが、「暗黙的に入力されたファイルの最長の共通パス」が設定される。SAM CLIでスクラッチ用のテンプレートでプロジェクトを作成するとファイルが1つだけあり、それがsrc/handlers/hello-from-lambda.jsとなっていて、この場合に推測されるルートディレクトリがsrc/handlersになるためこれは想定するルートディレクトリではないので明示的に書いている。
最終的にはsrcディレクトリの下にいくつかのディレクトリを作成してそれぞれファイルがある状態になるため想定したルートディレクトリになるはずだが構築中に想定外の状況が発生してしまうので明示的に指定しておいたほうが混乱は少ないと思われる。
jestをTypeScriptに対応させる テストフレームワークであるjestはそのままではTypeScriptでテストコードを書けない。公式ドキュメントによるとBabel経由でサポートするとあるがテストのためだけにいれるくらいならtscを経由したほうがマシと判断。ts-jestへの誘導もあるのでそちらを使う。
npm install ts-jest @types/jest --save-dev npx ts-jest config:init 参考:https://kulshekhar.github.io/ts-jest/docs/getting-started/installation
設定ファイルについてはts-jestが生成したものそのままで問題なし。
ここまででTypeScriptで開発を行う環境は整っている。プロジェクト作成時に作られたサンプルのソースをTypeScriptに合わせて変えていく。
モジュールのimport/exportの書き方をTypeScriptにあわせる TypeScriptはJavaScriptのスーパーセットなので基本はそのまま動くのだがCommonJSのrequire/exportsについて互換性がない。プロジェクト生成時のソースコードはCommonJSなのでrequire/exportsをimport/exportの書き方に合わせる必要がある。(ここの記述は自信がない)
まずは本体のソースコードを書き換える。
/** * A Lambda function that returns a static string */ - exports.</description>
    </item>
    
    <item>
      <title>ツイ禁日記2</title>
      <link>https://mianenico.github.io/article/dairy20210603/</link>
      <pubDate>Thu, 03 Jun 2021 21:51:07 +0900</pubDate>
      
      <guid>https://mianenico.github.io/article/dairy20210603/</guid>
      <description>Twitterやっていないせいなのか 妙にイライラすることが多い。ただ何かと原動力になるのでやっぱりない生活に慣れたい感じはある。ある程度になったらまたやりはじめるつもりだけど今月は控えておくかな。
スピーカーの位置が悪い 机が小さくてスピーカーの置く場所がないので本棚に押し込んでいてさらにディスプレイの裏にあるものだから音がひどくこもってしまう。
ということを日記に書こうとしたらひとつ下の棚の奥を1段下げて上向きにしたら丁度いいのではと思いついたので試してみた。ディスプレイの陰を回避したので確実に前よりはいい。どのみち場所が悪いことには変わりないのであまりこだわっても意味はないのだけれど。
仕事に集中できない タスクが多くて仕事に集中ができない。昔から複数プロジェクトを回すと切り替えがうまくできずに効率が落ちがちだったのだけれど、最近はそれに加えて窓口もやっていてとにかく割り込みが多い。ただでさえタスクの存在で集中力を欠いているのに割り込みでほとんど仕事になっていない。仕事を辞めたい理由はすべてこのマルチタスク前提のアサインのせい。
でも30代くらいの社会人ってこういう役回りが普通なのではとも思って今回ばかりは完全にどういう手を打つべきか悩んでいる。一つのプロジェクトに集中して黙々と作業をしていたいのだけれど人材としてはそういうのあまり効率よくなさそうだし。プログラミング領域で明確な武器となるなにかがあるならいいのだけれど。
好きなものは仕組み 何かと何かが組み合わさることで何かが実現できるという連携の仕組みが好きでプログラミングもこの仕組みを組み立てることに対して関心が強い。要するにプログラム設計領域なのだけれどはっきりとした正解がないので沼にハマりがち。でも楽しいからそういう仕事したいんだよ。請負つまらんのよ。
MyDNSの通知システムが一旦完成 とりあえず昨日の段階で出来上がっていた状態で動き出したので実行ファイルにして配置した。これでまたWSL2の定まらないIPに悩まされないはず。ビルドに必要なファイル作ってmain関数ベタがきの状態を関数に分けていけばとりあえず公開できるかなという感じ。公開しても使いみちそんなない気はしている。というかシェルスクリプトでもできそうではあるのよね。どちらかというとGoの勉強の要素が大きい感じ。
タイムトラッキングできるTODOアプリがほしい タイムトラッキングといえばTogglがあるけれどTODOアプリとしての機能は有料なので無料でほしいなと。割と理想に近いのはFocus To-Doだけどポモドーロがいらないのよね。あと何故か退会がない。こうなったら自分で作るかと思い出したところ。単純なTODOアプリなら作るのにそんなに時間はかからないかなぁ。
少しずつデザイン CSSを入れて少しずつブログっぽくなるように調整中。まだデザインをきちんと考えられていないけれどとりあえず見れるようになるまでは頑張る。HTMLいじりは20年ほど前からやっている趣味。</description>
    </item>
    
    <item>
      <title>ツイ禁日記1</title>
      <link>https://mianenico.github.io/article/dairy20210602/</link>
      <pubDate>Thu, 03 Jun 2021 02:43:14 +0900</pubDate>
      
      <guid>https://mianenico.github.io/article/dairy20210602/</guid>
      <description>Twitterから離れている 最近生活をTwitterに侵されている感じがあったのでクライアントアンインストールして離れている。
なにかあるたびにツイートするかと思ったり、やることがないと禁断症状みたいにものすごいTwitter見たい感覚に襲われるしストレスの捌け口がなくイライラし始める始末。我ながらひどい依存状態だなと思うのでしばらく我慢してみようと思う。
しかし、Twitterって見るまでにかかるコストがあまりにも小さいので暇つぶし性能がめちゃくちゃ高い。とりあえず見ておけばなにかやっている感覚があるので時間の無駄遣いにはもってこいである。
このなにかやっている感覚を得るためにツイッターやるのはあまりにももったいない。離れる前から虚無だなと思いながらやっていたけれど離れてみたらさらなる虚無が押し寄せてくる。この虚無を埋めていたのはTwitterという虚無だったというわけだ。
Twitterで潰していた暇をゲームとかに使えばいいのにと思いつつもゲームやる気がまったくないので娯楽への原動力をTwitterから得ていた可能性がいくらかある。
気持ちのアウトプット先もなくなったのでこうやって日記を書いてみようと思ったのでhugoでブログサイト作ろうとしているわけです。いつもTwitterに吐き出していたものを吐き出す場所がないので日記が捗りそうな気がする。
毎日はやらないかもだけど気が向いたらやる程度で考える。まだサイトデザインも作ってないし。
これとは別にもう少し生産的な何かをやろうかなと思って始めたのがちょっとしたツールづくり。WSL2のIPが定まらない問題を解決するためのツールを作ってます。
指定したNetwork interfaceのIP addressを取得して通知するツールをGoで作る これもとは別の方法でやっていたんですが、その別の方法が使えなくなって結構経つので自分で作ってみようかと。
こういう小さいツールは今ならGoで作るのが適切でしょうということでGoで書いてます。Ruby以外の武器を身に付けないといけないかなとも思うので。
100行程度のコードなんでまだ全然わからないけれど実現したいことに特に困りごとはないので色々ネタを探してGoで解決してみたいところ。
現状でとりあえず想定する動きはできたので一部動作確認取れていないコードもあるけど機能はする感じ。main関数にベタ書きなのでいろいろ関数化したりのリファクタリングをそのうちやる予定。
仕事辞めたい度 最近割と忙しいし自分のキャリアプランについても疑問があるのでなんとなく辞めたい気持ちが募っている。問題なのはもう若くないのでマッチするところがあるのかという点とそこまで技術力を誇れないという点。
正直なところ人やプロジェクトの管理をしているのはかなり辛くてコード全く書いていないわけではないのだけれど割り込みの多さに辟易している。客との窓口やるとマジで集中ができない。
今やりたいことはシステムやアプリケーションコードの改善。ひたすらきれいにしたい。今の請負の仕事ではどんどん汚くなるばかりだし継続的にやっていると汚くし続けているという状況が嫌になってくる。
割り込みとかなしにプログラミングに集中したいわ……</description>
    </item>
    
    <item>
      <title>First</title>
      <link>https://mianenico.github.io/article/first/</link>
      <pubDate>Wed, 02 Jun 2021 02:33:39 +0900</pubDate>
      
      <guid>https://mianenico.github.io/article/first/</guid>
      <description>最初の記事 hugoはじめました</description>
    </item>
    
  </channel>
</rss>
